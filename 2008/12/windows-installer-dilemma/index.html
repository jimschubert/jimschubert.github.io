<!DOCTYPE html>
<html lang="en">
    
    


    <head>
    <link href="https://gmpg.org/xfn/11" rel="profile">
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta http-equiv="Cache-Control" content="public" />
<!-- Enable responsiveness on mobile devices -->
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="generator" content="Hugo 0.72.0" />

    
    
    

<title>Windows Installer Dilemma • I Prefer Jim</title>


<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Windows Installer Dilemma"/>
<meta name="twitter:description" content="My current task is to create an installer. The dilemma: Visual Studio doesn’t provide a very robust Setup and Deployment project."/>

<meta property="og:title" content="Windows Installer Dilemma" />
<meta property="og:description" content="My current task is to create an installer. The dilemma: Visual Studio doesn’t provide a very robust Setup and Deployment project." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.ipreferjim.com/2008/12/windows-installer-dilemma/" />
<meta property="article:published_time" content="2008-12-14T15:15:00+00:00" />
<meta property="article:modified_time" content="2008-12-14T15:15:00+00:00" /><meta property="og:site_name" content="I Prefer Jim" />


    


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">








<link rel="stylesheet" href="/scss/hyde-hyde.1d734ca591261200417c9d5de423a667cc5271b6576cc2ea477fce0dd8c628d0.css">


<link rel="stylesheet" href="/scss/print.2744dcbf8a0b2e74f8a50e4b34e5f441be7cf93cc7de27029121c6a09f9e77bc.css" media="print">




<link rel="stylesheet" href="/scss/hugo-toc.11a9185f83b7761946f8d16ae214f4d959edaf003337338e55935920cc7852d7.css">



    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <!-- Icons -->
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
    <link rel="shortcut icon" href="/favicon.png">
    
    

</head>


    <body class=" ">
    
<div class="sidebar">
  <div class="container ">
    <div class="sidebar-about">
      <span class="site__title">
        <a href="https://www.ipreferjim.com/">I Prefer Jim</a>
      </span>
      
      
        <div class="author-image">
          <img src="https://www.gravatar.com/avatar/466dc28e15028c7353552022d2de1f9e?s=240&d=mp" class="img--circle img--headshot element--center" alt="gravatar">
        </div>
      
      <p class="site__description">
        
      </p>
    </div>
    <div class="collapsible-menu">
      <input type="checkbox" id="menuToggle">
      <label for="menuToggle">I Prefer Jim</label>
      <div class="menu-content">
        <div>
	<ul class="sidebar-nav">
		 
		 
			 
				<li>
					<a href="/posts/">
						<span>Posts</span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/tags/">
						<span>Tags</span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/categories/">
						<span>Categories</span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/books/">
						<span>Books</span>
					</a>
				</li>
			 
		
	</ul>
</div>

        <section class="social">
	
	<a href="https://twitter.com/jimschubert" rel="me"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a>
	
	
	
	<a href="https://github.com/jimschubert" rel="me"><i class="fab fa-github fa-lg" aria-hidden="true"></i></a>
	
	
	
	
	
	
	
	<a href="https://linkedin.com/in/jamesschubert" rel="me"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a>
	
	
	<a href="https://stackoverflow.com/users/151445" rel="me"><i class="fab fa-stack-overflow fa-lg" aria-hidden="true"></i></a>
	
	
	
	
	
	
	
	
</section>

      </div>
    </div>
    
<div class="copyright">
  &copy; 2020 Jim Schubert
  
    <a href="https://creativecommons.org/licenses/by-sa/4.0">CC BY-SA 4.0</a>
  
</div>


<div class="builtwith">
Built with <a href="https://gohugo.io">Hugo</a> ❤️ <a href="https://github.com/htr3n/hyde-hyde">hyde-hyde</a>.
</div>


  </div>
</div>

        <div class="content container">
            
    
<article>
  <header>
    <h1>Windows Installer Dilemma</h1>
    
    
<div class="post__meta">
    
    
      <i class="fas fa-calendar-alt"></i> Dec 14, 2008
    
    
    
      
      
          in
          
          
              <a class="badge badge-category" href="/categories/blog">BLOG</a>
              
          
      
    
    
    
      
      
          <br/>
           <i class="fas fa-tags"></i>
          
          <a class="badge badge-tag" href="/tags/errors">errors</a>
          
      
    
    
    <br/>
    <i class="fas fa-clock"></i> 3 min read
</div>


  </header>
  
  
  
  
  <div class="post">
    <p>My current task is to create an installer. The dilemma: Visual Studio doesn’t provide a very robust Setup and Deployment project.</p>
<p>The options?</p>
<ol>
<li>
<p>Create a <a href="http://wix.sf.net" target="_new">WiX Project</a></p>
</li>
<li>
<p>Write a bootstrapper/custom GUI/etc. and P/Invoke msi.dll</p>
</li>
<li>
<p>InstallShield ($$$)</p>
</li>
<li>
<p>Wise ($$$)</p>
</li>
<li>
<p><a href="http://nsis.sf.net" target="_new">Nullsoft Scriptable Install System</a></p>
</li>
</ol>
<p>Here’s what I’ve run into. WiX is pretty straight-forward and configurable. It is also open source, so you are able to rewrite the user-interfaces to fit your needs. The only thing is that the whole project is in XML, which means creating a dialog means setting values for buttons, labels, and textboxes manually. I’ve thought about writing a short program to create the dialogs for me, which I may still do. The problem I’ve found with WiX: I can’t figure out how to refer to code (Assembly Info). I have found two possibilities: <a href="http://andrewwhitten.wordpress.com/2007/09/19/how-to-insert-an-assembly-version-number-into-a-wix-script-at-build-time/" target="_new">replace WiX version via PowerShell script</a> and <a href="http://morten.lyhr.dk/2007/10/how-to-insert-assembly-version-number.html" target="_new">using MSBuild tasks</a>. However, my development team wants to make the project as simple as possible. Using WiX already means that everyone will have to install WiX in order to build the file properly. This will only be a problem until the next version of Visual Studio, which is supposed to ship with WiX installed.</p>
<p>Option 2 is one that I got from Rick Brewster, of <a href="http://www.getpaint.net/" target="_new">Paint.NET</a> fame. Well, not directly from him. Scott Hanselman has <a href="http://www.hanselman.com/blog/HanselminutesPodcast138PaintNETWithRickBrewster.aspx" target="_new">an excellent podcast</a> which details the Paint.NET installer. It is beautiful in it’s simplicity. I’ll leave a few things out, to tailor it to my discussion.</p>
<p>I’ll start from the outside-in.</p>
<ol>
<li>The installer comes as an executable created by NSIS (#5 above). This installer basically acts as a zip file, which extracts the contents to the user’s application folder and runs the bootstrapper.</li>
<li>The bootstrapper checks for the proper version of Windows, and .NET</li>
<li>If the requirements .NET aren’t met, the .NET redistributable installer can be run from the directory.</li>
<li>When everything is good, a custom GUI setup program runs.</li>
<li>The program gathers necessary information, injecting it into the MSI installer which is actually the same one created by Visual Studio.</li>
<li>Then, any number of MSI installers can be run.</li>
</ol>
<p>This method of staging, bootstrapping, gathering, and then running seems the most efficient. The problem is that the whole MSI interoperability means having a full understanding of Windows Installer technology. It is possible, however, to simplify this even further. On the progress form, use msiexec and switches. Because I’m not that interested in fully understanding the Windows Installer technology at the moment, this option is a little more than I want to get into. But, I have actually started a project that uses a very similar method.</p>
<p>InstallShield and Wise cost money, so they are not options for me.</p>
<p>NSIS is another excellent option. The only problem I see with it is that it’s like learning another scripting language. Although it is very simple, it doesn’t particularly appeal to me. XML, however, does.</p>
<p>So, it looks like I’m going to go with WiX as my choice to create an installer.</p>

  </div>
  

<div class="navigation navigation-single">
    
    <a href="/2008/12/net-development/" class="navigation-prev">
      <i aria-hidden="true" class="fa fa-chevron-left"></i>
      <span class="navigation-tittle">.NET development</span>
    </a>
    
    
    <a href="/2008/12/wix-first-impressions/" class="navigation-next">
      <span class="navigation-tittle">WiX: First impressions.</span>
      <i aria-hidden="true" class="fa fa-chevron-right"></i>
    </a>
    
</div>


  




  
    


</article>


        </div>
        
    

<script defer src="https://use.fontawesome.com/releases/v5.11.2/js/all.js" integrity="sha384-b3ua1l97aVGAPEIe48b4TC60WUQbQaGi2jqAWM90y0OZXZeyaTCWtBTKtjW2GXG1" crossorigin="anonymous"></script>


    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/highlight.min.js"></script>
        
    <script type="text/javascript">
        
        hljs.initHighlightingOnLoad();
    </script>
    





    



    </body>
</html>
