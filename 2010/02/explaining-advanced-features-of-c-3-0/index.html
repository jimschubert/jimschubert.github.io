<!DOCTYPE html>
<html lang="en">
    
    


    <head>
    <link href="https://gmpg.org/xfn/11" rel="profile">
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta http-equiv="Cache-Control" content="public" />
<!-- Enable responsiveness on mobile devices -->
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="generator" content="Hugo 0.72.0" />

    
    
    

<title>Explaining advanced features of C# 3.0 • I Prefer Jim</title>


<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Explaining advanced features of C# 3.0"/>
<meta name="twitter:description" content="C# 3.0 Func delegates and Expressions In this post, I’ll attempt to clarify the meaning of Func delegates and Expressions."/>

<meta property="og:title" content="Explaining advanced features of C# 3.0" />
<meta property="og:description" content="C# 3.0 Func delegates and Expressions In this post, I’ll attempt to clarify the meaning of Func delegates and Expressions." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.ipreferjim.com/2010/02/explaining-advanced-features-of-c-3-0/" />
<meta property="article:published_time" content="2010-02-15T23:07:30+00:00" />
<meta property="article:modified_time" content="2010-02-15T23:07:30+00:00" /><meta property="og:site_name" content="I Prefer Jim" />


    


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">








<link rel="stylesheet" href="/scss/hyde-hyde.1d734ca591261200417c9d5de423a667cc5271b6576cc2ea477fce0dd8c628d0.css">


<link rel="stylesheet" href="/scss/print.2744dcbf8a0b2e74f8a50e4b34e5f441be7cf93cc7de27029121c6a09f9e77bc.css" media="print">




<link rel="stylesheet" href="/scss/hugo-toc.11a9185f83b7761946f8d16ae214f4d959edaf003337338e55935920cc7852d7.css">



    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <!-- Icons -->
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
    <link rel="shortcut icon" href="/favicon.png">
    
    

</head>


    <body class=" ">
    
<div class="sidebar">
  <div class="container ">
    <div class="sidebar-about">
      <span class="site__title">
        <a href="https://www.ipreferjim.com/">I Prefer Jim</a>
      </span>
      
      
        <div class="author-image">
          <img src="https://www.gravatar.com/avatar/466dc28e15028c7353552022d2de1f9e?s=240&d=mp" class="img--circle img--headshot element--center" alt="gravatar">
        </div>
      
      <p class="site__description">
        
      </p>
    </div>
    <div class="collapsible-menu">
      <input type="checkbox" id="menuToggle">
      <label for="menuToggle">I Prefer Jim</label>
      <div class="menu-content">
        <div>
	<ul class="sidebar-nav">
		 
		 
			 
				<li>
					<a href="/posts/">
						<span>Posts</span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/tags/">
						<span>Tags</span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/categories/">
						<span>Categories</span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/books/">
						<span>Books</span>
					</a>
				</li>
			 
		
	</ul>
</div>

        <section class="social">
	
	<a href="https://twitter.com/jimschubert" rel="me"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a>
	
	
	
	<a href="https://github.com/jimschubert" rel="me"><i class="fab fa-github fa-lg" aria-hidden="true"></i></a>
	
	
	
	
	
	
	
	<a href="https://linkedin.com/in/jamesschubert" rel="me"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a>
	
	
	<a href="https://stackoverflow.com/users/151445" rel="me"><i class="fab fa-stack-overflow fa-lg" aria-hidden="true"></i></a>
	
	
	
	
	
	
	
	
</section>

      </div>
    </div>
    
<div class="copyright">
  &copy; 2020 Jim Schubert
  
    <a href="https://creativecommons.org/licenses/by-sa/4.0">CC BY-SA 4.0</a>
  
</div>


<div class="builtwith">
Built with <a href="https://gohugo.io">Hugo</a> ❤️ <a href="https://github.com/htr3n/hyde-hyde">hyde-hyde</a>.
</div>


  </div>
</div>

        <div class="content container">
            
    
<article>
  <header>
    <h1>Explaining advanced features of C# 3.0</h1>
    
    
<div class="post__meta">
    
    
      <i class="fas fa-calendar-alt"></i> Feb 15, 2010
    
    
    
      
      
          in
          
          
              <a class="badge badge-category" href="/categories/blog">BLOG</a>
              
          
      
    
    
    
      
      
          <br/>
           <i class="fas fa-tags"></i>
          
          <a class="badge badge-tag" href="/tags/.net">.net</a>
           
      
          <a class="badge badge-tag" href="/tags/advanced">advanced</a>
           
      
          <a class="badge badge-tag" href="/tags/c">c#</a>
           
      
          <a class="badge badge-tag" href="/tags/exploring">exploring</a>
          
      
    
    
    <br/>
    <i class="fas fa-clock"></i> 7 min read
</div>


  </header>
  
  
  
  
  <div class="post">
    <h1 id="c-30-func-delegates-and-expressions">C# 3.0 Func delegates and Expressions</h1>
<p>In this post, I’ll attempt to clarify the meaning of Func delegates and Expressions.</p>
<p>These are very useful additions to C# 3.0, but it seems to be rarely blogged about.</p>
<div class="highlight"><pre class="chroma"><code class="language-csharp" data-lang="csharp"><span class="c1">// Note: I assume you have a general understanding of delegates and anonymous method
</span></code></pre></div><h2 id="microsoft8217s-definitions">Microsoft’s definitions:</h2>
<h3 id="func">Func</h3>
<div class="highlight"><pre class="chroma"><code class="language-csharp" data-lang="csharp"><span class="c1">// Encapsulates a method that has no parameters and returns 
</span><span class="c1">// a value of the type specified by the TResult parameter.
</span><span class="c1"></span><span class="k">public</span> <span class="k">delegate</span> <span class="n">TResult</span> <span class="n">Func</span><span class="p">&lt;</span><span class="n">TResult</span><span class="p">&gt;()</span>
<span class="k">public</span> <span class="k">delegate</span> <span class="n">TResult</span> <span class="n">Func</span><span class="p">&lt;</span><span class="n">TParam0</span><span class="p">,</span> <span class="n">TResult</span><span class="p">&gt;(</span><span class="n">TParam0</span> <span class="n">arg0</span><span class="p">)</span>
<span class="k">public</span> <span class="k">delegate</span> <span class="n">TResult</span> <span class="n">Func</span><span class="p">&lt;</span><span class="n">TParam0</span><span class="p">,</span> <span class="n">TParam1</span><span class="p">,</span> <span class="n">TResult</span><span class="p">&gt;(</span><span class="n">TParam0</span> <span class="n">arg0</span><span class="p">,</span> <span class="n">TParam1</span> <span class="n">arg1</span><span class="p">)</span>
<span class="c1">// etc. up to 3 Generic Input parameters and a Generic Result parameter
</span></code></pre></div><h3 id="expression">Expression</h3>
<div class="highlight"><pre class="chroma"><code class="language-csharp" data-lang="csharp"><span class="c1">// Represents a strongly typed lambda expression as a data structure 
</span><span class="c1">// in the form of an expression tree. This class cannot be inherited.
</span><span class="c1"></span><span class="k">public</span> <span class="k">sealed</span> <span class="k">class</span> <span class="nc">Expression</span><span class="p">&lt;</span><span class="n">TDelegate</span><span class="p">&gt;</span> <span class="p">:</span> <span class="n">LambdaExpression</span>

<span class="c1">// Describes a lambda expression.
</span><span class="c1"></span><span class="k">public</span> <span class="k">class</span> <span class="nc">LambdaExpression</span> <span class="p">:</span> <span class="n">Expression</span>

<span class="c1">// Provides the base class from which the classes that represent expression 
</span><span class="c1">// tree nodes are derived. It also contains static (Shared in Visual Basic) 
</span><span class="c1">// factory methods to create the various node types. This is an abstract class.
</span><span class="c1"></span><span class="k">public</span> <span class="k">abstract</span> <span class="k">class</span> <span class="nc">Expression</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-csharp" data-lang="csharp"><span class="c1">// NOTE : Expression&lt;TDelegate&gt; is not an override of Expression, they are completely independent classes
</span></code></pre></div><h1 id="quick-rundown">Quick Rundown</h1>
<h2 id="functresult">Func<TResult></h2>
<p>The Func delegates are simply Generic delegates introduced to make our lives easier. You specify your return type, or the types of your input parameters and your return type.</p>
<p>For instance, assume you have an object called Product, with a method whose signature is:</p>
<div class="highlight"><pre class="chroma"><code class="language-csharp" data-lang="csharp"><span class="k">public</span> <span class="kt">bool</span> <span class="n">AddComponent</span><span class="p">(</span><span class="n">Component</span> <span class="n">c</span><span class="p">)</span> <span class="p">{</span> <span class="cm">/* logic */</span> 
</code></pre></div><p>You could use the Func delegate in a number of ways on the product object:</p>
<div class="highlight"><pre class="chroma"><code class="language-csharp" data-lang="csharp"><span class="c1">// our objects
</span><span class="c1"></span><span class="n">Product</span> <span class="n">product</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Product</span><span class="p">();</span>

<span class="c1">// Examples
</span><span class="c1"></span><span class="n">Func</span><span class="p">&lt;</span><span class="kt">bool</span><span class="p">&gt;</span> <span class="n">addComponent1</span> <span class="p">=</span> <span class="n">product</span><span class="p">.</span><span class="n">AddComponent</span><span class="p">(</span> <span class="k">new</span> <span class="n">Component</span><span class="p">()</span> <span class="p">);</span>
<span class="n">Func</span><span class="p">&lt;</span><span class="kt">bool</span><span class="p">&gt;</span> <span class="n">addComponent2</span> <span class="p">=</span> <span class="k">delegate</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span>  <span class="n">product</span><span class="p">.</span><span class="n">AddComponent</span><span class="p">(</span> <span class="k">new</span> <span class="n">Component</span><span class="p">()</span> <span class="p">);</span> <span class="p">};</span>
<span class="n">Func</span><span class="p">&lt;</span><span class="kt">bool</span><span class="p">&gt;</span> <span class="n">addComponent3</span> <span class="p">=</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="n">product</span><span class="p">.</span><span class="n">AddComponent</span><span class="p">(</span> <span class="k">new</span> <span class="n">Component</span><span class="p">()</span> <span class="p">);</span>

<span class="k">if</span><span class="p">(</span><span class="n">addComponent1</span><span class="p">())</span> <span class="p">{</span> <span class="cm">/* Do stuff */</span> <span class="p">}</span>
<span class="k">if</span><span class="p">(</span><span class="n">addComponent2</span><span class="p">())</span> <span class="p">{</span> <span class="cm">/* Do stuff */</span> <span class="p">}</span>
<span class="k">if</span><span class="p">(</span><span class="n">addComponent3</span><span class="p">())</span> <span class="p">{</span> <span class="cm">/* Do stuff */</span> <span class="p">}</span>
</code></pre></div><p>The above example is the common explanation of Func delegates. However, to a beginner, this may seem like a ridiculous way to rename a method. The point being, it can be difficult to understand why you’d generalize</p>
<div class="highlight"><pre class="chroma"><code class="language-csharp" data-lang="csharp"><span class="n">product</span><span class="p">.</span><span class="n">AddComponent</span><span class="p">(</span> <span class="k">new</span> <span class="n">Component</span><span class="p">()</span> <span class="p">)</span>
</code></pre></div><p>as ‘addComponent1’ when you could just as easily write out</p>
<div class="highlight"><pre class="chroma"><code class="language-csharp" data-lang="csharp"><span class="k">if</span><span class="p">(</span><span class="n">product</span><span class="p">.</span><span class="n">AddComponent</span><span class="p">(</span> <span class="k">new</span> <span class="n">Component</span><span class="p">()</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span> <span class="cm">/* Do stuff */</span> <span class="p">}</span>
</code></pre></div><p>Another, more useful example of a real-world application:</p>
<div class="highlight"><pre class="chroma"><code class="language-csharp" data-lang="csharp"><span class="n">Product</span> <span class="n">product</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Product</span><span class="p">();</span>
<span class="n">Func</span><span class="p">&lt;</span><span class="kt">bool</span><span class="p">&gt;</span> <span class="n">addAllProducts</span> <span class="p">=</span> <span class="p">()</span> <span class="p">=&gt;</span>
    <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">product</span><span class="p">.</span><span class="n">AddComponent</span><span class="p">(</span><span class="k">new</span> <span class="n">Component</span> <span class="p">{</span> <span class="n">Name</span> <span class="p">=</span> <span class="s">&#34;Component1&#34;</span> <span class="p">})</span>
        <span class="p">&amp;&amp;</span> <span class="n">product</span><span class="p">.</span><span class="n">AddComponent</span><span class="p">(</span><span class="k">new</span> <span class="n">Component</span> <span class="p">{</span> <span class="n">Name</span> <span class="p">=</span> <span class="s">&#34;Component2&#34;</span> <span class="p">})</span>
        <span class="p">&amp;&amp;</span> <span class="n">product</span><span class="p">.</span><span class="n">AddComponent</span><span class="p">(</span><span class="k">new</span> <span class="n">Component</span> <span class="p">{</span> <span class="n">Name</span> <span class="p">=</span> <span class="s">&#34;Component3&#34;</span> <span class="p">}))</span>
        <span class="p">{</span> <span class="k">return</span> <span class="k">true</span><span class="p">;</span> <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="k">false</span><span class="p">;</span> <span class="p">}</span>
    <span class="p">};</span>

<span class="kt">bool</span> <span class="n">wasSuccessful</span> <span class="p">=</span> <span class="n">addAllProducts</span><span class="p">();</span> <span class="c1">// wasSuccessful is true if AddComponent succeeds every time.
</span></code></pre></div><div class="highlight"><pre class="chroma"><code class="language-csharp" data-lang="csharp"><span class="c1">// NOTE: Here, I&#39;ve used object instantiation for the Component object, this is another feature of C# 3.
</span></code></pre></div><h2 id="expressiontdelegate">Expression<TDelegate></h2>
<p>Of particular note is the difference between Func<TResult> and Expression<TDelegate>. A Func<TResult> is code (a delegate) that is compiled at runtime, while an Expression<TDelegate> is a data representation (as an Expression Tree) of that delegate. This means you can act upon any part of an Expression<TDelegate> as if it were a data structure (similar to getting a count of objects in a list or accessing a dictionary value via dictionary key).</p>
<p>You’ve probably read that paragraph and said “…what?” If so, I don’t blame you.</p>
<p>Take, for instance, the example given at MSDN:</p>
<div class="highlight"><pre class="chroma"><code class="language-csharp" data-lang="csharp"><span class="n">System</span><span class="p">.</span><span class="n">Linq</span><span class="p">.</span><span class="n">Expressions</span><span class="p">.</span><span class="n">Expression</span><span class="p">&lt;</span><span class="n">Func</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="kt">bool</span><span class="p">&gt;&gt;</span> <span class="n">expr</span> <span class="p">=</span> <span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="m">5</span>
</code></pre></div><p>This doesn’t give us much to go by. However, when you think about expr as a data structure, you’re basically instantiating this data structure with ‘i =&gt; i &lt; 5;&rsquo;. Now, you can pass this expression tree around your application and you&rsquo;re free to access any part of the expression tree as if it is its own separate entity; you can&rsquo;t do this with a delegate alone. A fairly good example is available at <a href="http://msdn.microsoft.com/en-us/library/bb397951.aspx">MSDN</a>.</p>
<p>To better clarify, let’s look at the parts of this expression tree:&lt;ul style=&quot;padding:0;margin:0;&gt;</p>
<li style="padding:0;margin:0;">
  Expression
</li>
<li style="padding:0;margin:0;">
  Parameter
</li>
  * Body <ul style="padding:-2px;margin:0;">
      <li  style="padding:0;margin:0;list-style-type:none !important;">
        &#8211;Operation
      </li>
      <li  style="padding:0;margin:0;list-style-type:none !important;">
        &#8211;Constant
      </li>
    </ul></ul> 
<div class="highlight"><pre class="chroma"><code class="language-csharp" data-lang="csharp"><span class="cm">/* Expression */</span> <span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="m">5</span><span class="p">;</span>
<span class="cm">/* Parameter */</span>  <span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="cm">/* Body */</span>  <span class="n">i</span> <span class="p">&lt;</span> <span class="m">5</span><span class="p">;</span> 
<span class="cm">/* Operation NodeType */</span> <span class="p">&lt;</span> 
<span class="cm">/* Constant */</span> <span class="m">5</span> 
</code></pre></div><p>I know breaking it down into these parts seems very simplistic, but the point is that you can’t do this with a delegate. If you passed a delegate to a method, that’s it. You can’t figure out what the first parameter was declared as, or the operation being performed (less than, greater than, etc). You’d have no way of finding what constant was supplied.</p>
<p>To compile the above Expression tree, you could do the following:</p>
<div class="highlight"><pre class="chroma"><code class="language-csharp" data-lang="csharp"><span class="kt">bool</span> <span class="n">oneIsLess</span> <span class="p">=</span> <span class="n">expr</span><span class="p">.</span><span class="n">Compile</span><span class="p">()(</span><span class="m">1</span><span class="p">);</span> <span class="p">/*</span> <span class="n">result</span><span class="p">:</span> <span class="k">true</span> <span class="p">*</span>
</code></pre></div><p>Why is this important? You can easily access the parts of the expression as described by the MSDN article:</p>
<div class="highlight"><pre class="chroma"><code class="language-csharp" data-lang="csharp"><span class="n">Expression</span><span class="p">&lt;</span><span class="n">Func</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="kt">bool</span><span class="p">&gt;&gt;</span> <span class="n">exprTree</span> <span class="p">=</span> <span class="n">num</span> <span class="p">=&gt;</span> <span class="n">num</span> <span class="p">&lt;</span> <span class="m">5</span><span class="p">;</span>

<span class="n">ParameterExpression</span> <span class="n">param</span> <span class="p">=</span> <span class="p">(</span><span class="n">ParameterExpression</span><span class="p">)</span><span class="n">exprTree</span><span class="p">.</span><span class="n">Parameters</span><span class="p">[</span><span class="m">0</span><span class="p">];</span>
<span class="n">BinaryExpression</span> <span class="n">operation</span> <span class="p">=</span> <span class="p">(</span><span class="n">BinaryExpression</span><span class="p">)</span><span class="n">exprTree</span><span class="p">.</span><span class="n">Body</span><span class="p">;</span>
<span class="n">ParameterExpression</span> <span class="n">left</span> <span class="p">=</span> <span class="p">(</span><span class="n">ParameterExpression</span><span class="p">)</span><span class="n">operation</span><span class="p">.</span><span class="n">Left</span><span class="p">;</span>
<span class="n">ConstantExpression</span> <span class="n">right</span> <span class="p">=</span> <span class="p">(</span><span class="n">ConstantExpression</span><span class="p">)</span><span class="n">operation</span><span class="p">.</span><span class="n">Right</span><span class="p">;</span>

<span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&#34;Decomposed expression: {0} =&gt; {1} {2} {3}&#34;</span><span class="p">,</span>
                  <span class="n">param</span><span class="p">.</span><span class="n">Name</span><span class="p">,</span> <span class="n">left</span><span class="p">.</span><span class="n">Name</span><span class="p">,</span> <span class="n">operation</span><span class="p">.</span><span class="n">NodeType</span><span class="p">,</span> <span class="n">right</span><span class="p">.</span><span class="n">Value</span><span class="p">);</span>

<span class="c1">// This code produces the following output:
</span><span class="c1">//  Decomposed expression: num =&gt; num LessThan 5
</span></code></pre></div><p>Using the <a href="http://msdn.microsoft.com/en-us/library/bb882521.aspx">Expression Tree Visitor</a> from MSDN, you can access the parts of a number of Expression Trees.</p>
<h2 id="practical-applications">Practical Applications</h2>
<p>Because this post is already very long, instead of going in-depth into practical applications now, I’ll save that for a future post.</p>
<p>Instead, I’d like to direct you to the project and usage of Expression trees that made me delve further into the topic: Fluent NHibernate. I had previously thought that Expression Trees and Lamda Expressions were geared more toward LINQ providers and less important for daily development. However, if you were to download the source for Fluent NHibernate, you’d see another cool usage of Expression Trees: <strong>static reflection</strong>.</p>
<p>James Gregory, the principal developer of Fluent NHibernate wrote a nice <a href="http://jagregory.com/writings/introduction-to-static-reflection/">introduction to static reflection</a>, in which he illustrates the following usage:</p>
<div class="highlight"><pre class="chroma"><code class="language-csharp" data-lang="csharp"><span class="cm">/* Copyright James Gregory, Creative Commons:Attribution-Non-Commercial-Share Alike 2.0 UK: England &amp; Wales */</span>
<span class="k">public</span> <span class="n">PropertyInfo</span> <span class="n">GetProperty</span><span class="p">&lt;</span><span class="n">TEntity</span><span class="p">&gt;(</span><span class="n">Expression</span><span class="p">&lt;</span><span class="n">Func</span><span class="p">&lt;</span><span class="n">TEntity</span><span class="p">,</span> <span class="kt">object</span><span class="p">&gt;&gt;</span> <span class="n">expression</span><span class="p">)</span> <span class="p">{</span> <span class="cm">/* Do stuff */</span> <span class="p">}</span>
<span class="n">GetProperty</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;(</span><span class="n">customer</span> <span class="p">=&gt;</span> <span class="n">customer</span><span class="p">.</span><span class="n">Name</span><span class="p">);</span> <span class="c1">// usage
</span></code></pre></div><p>As you can see, instead of retrieving the PropertyInfo of the Customer object’s Name property by hard-coding a “Name” string, you’re now free to refactor your code properly. In which case, if you were to change your ‘Name’ property, your tests or build process would fail, whereas the hard-coded string “Name” would be overlooked.</p>
<p>I encourage you to download the source code for <a href="http://fluentnhibernate.org/">Fluent NHibernate</a> and take a look at how static reflection is being used.</p>
<h4 id="further-reading">Further Reading</h4>
<p><a href="http://www.lostechies.com/blogs/gabrielschenker/archive/2009/02/03/dynamic-reflection-versus-static-reflection.aspx">http://www.lostechies.com/blogs/gabrielschenker/archive/2009/02/03/dynamic-reflection-versus-static-reflection.aspx</a></p>
<p><a href="http://www.codeproject.com/Articles/36262/Getting-Fun-with-Net-Static-Reflection.aspx">http://www.codeproject.com/Articles/36262/Getting-Fun-with-Net-Static-Reflection.aspx</a></p>
<p><a href="http://ayende.com/Blog/archive/2005/10/29/StaticReflection.aspx">http://ayende.com/Blog/archive/2005/10/29/StaticReflection.aspx</a></p>
<p><a href="http://apobekiaris.blogspot.com/2009/06/more-static-reflection.html">http://apobekiaris.blogspot.com/2009/06/more-static-reflection.html</a></p>
<h2 id="example-console-application">Example Console Application</h2>
<div class="highlight"><pre class="chroma"><code class="language-csharp" data-lang="csharp"><span class="k">static</span> <span class="k">void</span> <span class="n">Main</span><span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">List</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span> <span class="n">numbers</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;();</span>
            <span class="n">Random</span> <span class="n">r</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Random</span><span class="p">();</span>
            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="m">15</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
            <span class="p">{</span>
                <span class="n">numbers</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="n">r</span><span class="p">.</span><span class="n">Next</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">50</span><span class="p">));</span>
            <span class="p">}</span>

            <span class="c1">// Expression trees can be used to perform an action on objects
</span><span class="c1"></span>            <span class="n">Expression</span><span class="p">&lt;</span><span class="n">Func</span><span class="p">&lt;</span><span class="n">List</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;,</span><span class="kt">int</span><span class="p">,</span> <span class="kt">bool</span><span class="p">&gt;&gt;</span> <span class="n">isAvailable</span> <span class="p">=</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">num</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">Contains</span><span class="p">(</span><span class="n">num</span><span class="p">);</span>
            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="m">50</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
            <span class="p">{</span>
                <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&#34;Is {0} available? {1}&#34;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">isAvailable</span><span class="p">.</span><span class="n">Compile</span><span class="p">()(</span><span class="n">numbers</span><span class="p">,</span> <span class="n">i</span><span class="p">));</span>
            <span class="p">}</span>

            <span class="n">Product</span> <span class="n">product</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Product</span><span class="p">();</span>
            <span class="n">Func</span><span class="p">&lt;</span><span class="kt">bool</span><span class="p">&gt;</span> <span class="n">addAllProducts</span> <span class="p">=</span> <span class="p">()</span> <span class="p">=&gt;</span>
            <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">product</span><span class="p">.</span><span class="n">AddComponent</span><span class="p">(</span><span class="k">new</span> <span class="n">Component</span> <span class="p">{</span> <span class="n">Name</span> <span class="p">=</span> <span class="s">&#34;Component1&#34;</span> <span class="p">})</span>
                    <span class="p">&amp;&amp;</span> <span class="n">product</span><span class="p">.</span><span class="n">AddComponent</span><span class="p">(</span><span class="k">new</span> <span class="n">Component</span> <span class="p">{</span> <span class="n">Name</span> <span class="p">=</span> <span class="s">&#34;Component2&#34;</span> <span class="p">})</span>
                    <span class="c1">// &amp;&amp; product.AddComponent(new Component { Name = &#34;Component2&#34; }) /* fails */
</span><span class="c1"></span>                    <span class="p">&amp;&amp;</span> <span class="n">product</span><span class="p">.</span><span class="n">AddComponent</span><span class="p">(</span><span class="k">new</span> <span class="n">Component</span> <span class="p">{</span> <span class="n">Name</span> <span class="p">=</span> <span class="s">&#34;Component3&#34;</span> <span class="p">}))</span>
                <span class="p">{</span> <span class="k">return</span> <span class="k">true</span><span class="p">;</span> <span class="p">}</span>
                <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="k">false</span><span class="p">;</span> <span class="p">}</span>
            <span class="p">};</span>

            <span class="kt">bool</span> <span class="n">wasSuccessful</span> <span class="p">=</span> <span class="n">addAllProducts</span><span class="p">();</span>

            <span class="n">System</span><span class="p">.</span><span class="n">Linq</span><span class="p">.</span><span class="n">Expressions</span><span class="p">.</span><span class="n">Expression</span><span class="p">&lt;</span><span class="n">Func</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="kt">bool</span><span class="p">&gt;&gt;</span> <span class="n">expr</span> <span class="p">=</span> <span class="n">i</span> <span class="p">=&gt;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="m">5</span><span class="p">;</span>

            <span class="n">ParameterExpression</span> <span class="n">param</span> <span class="p">=</span> <span class="p">(</span><span class="n">ParameterExpression</span><span class="p">)</span><span class="n">expr</span><span class="p">.</span><span class="n">Parameters</span><span class="p">[</span><span class="m">0</span><span class="p">];</span>
            <span class="n">BinaryExpression</span> <span class="n">operation</span> <span class="p">=</span> <span class="p">(</span><span class="n">BinaryExpression</span><span class="p">)</span><span class="n">expr</span><span class="p">.</span><span class="n">Body</span><span class="p">;</span>
            <span class="n">ParameterExpression</span> <span class="n">left</span> <span class="p">=</span> <span class="p">(</span><span class="n">ParameterExpression</span><span class="p">)</span><span class="n">operation</span><span class="p">.</span><span class="n">Left</span><span class="p">;</span>
            <span class="n">ConstantExpression</span> <span class="n">right</span> <span class="p">=</span> <span class="p">(</span><span class="n">ConstantExpression</span><span class="p">)</span><span class="n">operation</span><span class="p">.</span><span class="n">Right</span><span class="p">;</span>

            <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&#34;Decomposed expression: {0} =&gt; {1} {2} {3}&#34;</span><span class="p">,</span>
                              <span class="n">param</span><span class="p">.</span><span class="n">Name</span><span class="p">,</span> <span class="n">left</span><span class="p">.</span><span class="n">Name</span><span class="p">,</span> <span class="n">operation</span><span class="p">.</span><span class="n">NodeType</span><span class="p">,</span> <span class="n">right</span><span class="p">.</span><span class="n">Value</span><span class="p">);</span>

        <span class="p">}</span>     
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">class</span> <span class="nc">Product</span>
    <span class="p">{</span>
        <span class="k">public</span> <span class="n">IList</span><span class="p">&lt;</span><span class="n">Component</span><span class="p">&gt;</span> <span class="n">Components</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">private</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
        <span class="k">public</span> <span class="kt">bool</span> <span class="n">AddComponent</span><span class="p">(</span><span class="n">Component</span> <span class="n">c</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">Components</span><span class="p">.</span><span class="n">Contains</span><span class="p">(</span><span class="n">c</span><span class="p">))</span>
                <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
            <span class="k">else</span>
            <span class="p">{</span>
                <span class="n">Components</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="n">c</span><span class="p">);</span>
                <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="n">Product</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">Components</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">Component</span><span class="p">&gt;();</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">class</span> <span class="nc">Component</span>
    <span class="p">{</span>
        <span class="k">public</span> <span class="kt">string</span> <span class="n">Name</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
        <span class="k">public</span> <span class="k">override</span> <span class="kt">bool</span> <span class="n">Equals</span><span class="p">(</span><span class="kt">object</span> <span class="n">obj</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span><span class="p">(!(</span><span class="n">obj</span> <span class="k">is</span> <span class="n">Component</span><span class="p">))</span> <span class="p">{</span> <span class="k">return</span> <span class="k">false</span><span class="p">;</span> <span class="p">}</span>
            <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="n">Name</span><span class="p">.</span><span class="n">Equals</span><span class="p">(((</span><span class="n">Component</span><span class="p">)</span><span class="n">obj</span><span class="p">).</span><span class="n">Name</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
</code></pre></div>
  </div>
  

<div class="navigation navigation-single">
    
    <a href="/2010/02/google-chrome-extension-new-tab-redirect-step-by-step/" class="navigation-prev">
      <i aria-hidden="true" class="fa fa-chevron-left"></i>
      <span class="navigation-tittle">Google Chrome Extension: New Tab Redirect! STEP BY STEP</span>
    </a>
    
    
    <a href="/2010/02/posting-data-to-a-remove-server-via-net/" class="navigation-next">
      <span class="navigation-tittle">Basics: Posting data to a remote server via .NET</span>
      <i aria-hidden="true" class="fa fa-chevron-right"></i>
    </a>
    
</div>


  


<div class="post__related">
    
    <h2>Related Articles</h2>
    <ul class="related-posts">
        
<li>
  <span class="list__title--small">
    <a href="/2009/12/extending-idatareader/" >Extending IDataReader</a>
      
      <time class="pull-right hidden-tablet">Dec 16, 2009</time>
      
  </span>
</li>

<li>
  <span class="list__title--small">
    <a href="/2008/12/net-development/" >.NET development</a>
      
      <time class="pull-right hidden-tablet">Dec 13, 2008</time>
      
  </span>
</li>

<li>
  <span class="list__title--small">
    <a href="/2010/02/quickly-create-a-dictionary-using-linq-to-objects/" >Quickly create a Dictionary using Linq to Objects</a>
      
      <time class="pull-right hidden-tablet">Feb 10, 2010</time>
      
  </span>
</li>

<li>
  <span class="list__title--small">
    <a href="/2009/11/converting-from-vs2003-to-vs2008/" >Converting from VS2003 to VS2008</a>
      
      <time class="pull-right hidden-tablet">Nov 3, 2009</time>
      
  </span>
</li>

<li>
  <span class="list__title--small">
    <a href="/2009/04/storing-generics-in-asp-net-profile-object/" >Storing Generics in ASP.NET Profile object</a>
      
      <time class="pull-right hidden-tablet">Apr 25, 2009</time>
      
  </span>
</li>


    </ul>
</div>



  
    


</article>


        </div>
        
    

<script defer src="https://use.fontawesome.com/releases/v5.11.2/js/all.js" integrity="sha384-b3ua1l97aVGAPEIe48b4TC60WUQbQaGi2jqAWM90y0OZXZeyaTCWtBTKtjW2GXG1" crossorigin="anonymous"></script>


    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/highlight.min.js"></script>
        
    <script type="text/javascript">
        
        hljs.initHighlightingOnLoad();
    </script>
    





    



    </body>
</html>
