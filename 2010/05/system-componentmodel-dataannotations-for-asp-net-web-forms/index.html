<!DOCTYPE html>
<html lang="en">
    
    


    <head>
    <link href="https://gmpg.org/xfn/11" rel="profile">
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta http-equiv="Cache-Control" content="public" />
<!-- Enable responsiveness on mobile devices -->
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="generator" content="Hugo 0.72.0" />

    
    
    

<title>System.ComponentModel.DataAnnotations for ASP.NET Web Forms • I Prefer Jim</title>


<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="System.ComponentModel.DataAnnotations for ASP.NET Web Forms"/>
<meta name="twitter:description" content="Although I’m primarily an ASP.NET Web Forms developer, I regularly dabble in new and interesting technologies. I’ve toyed with other Microsoft technologies such as ASP."/>

<meta property="og:title" content="System.ComponentModel.DataAnnotations for ASP.NET Web Forms" />
<meta property="og:description" content="Although I’m primarily an ASP.NET Web Forms developer, I regularly dabble in new and interesting technologies. I’ve toyed with other Microsoft technologies such as ASP." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.ipreferjim.com/2010/05/system-componentmodel-dataannotations-for-asp-net-web-forms/" />
<meta property="article:published_time" content="2010-05-27T01:50:19+00:00" />
<meta property="article:modified_time" content="2010-05-27T01:50:19+00:00" /><meta property="og:site_name" content="I Prefer Jim" />


    


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">








<link rel="stylesheet" href="/scss/hyde-hyde.1d734ca591261200417c9d5de423a667cc5271b6576cc2ea477fce0dd8c628d0.css">


<link rel="stylesheet" href="/scss/print.2744dcbf8a0b2e74f8a50e4b34e5f441be7cf93cc7de27029121c6a09f9e77bc.css" media="print">




<link rel="stylesheet" href="/scss/hugo-toc.11a9185f83b7761946f8d16ae214f4d959edaf003337338e55935920cc7852d7.css">



    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <!-- Icons -->
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
    <link rel="shortcut icon" href="/favicon.png">
    
    

</head>


    <body class=" ">
    
<div class="sidebar">
  <div class="container ">
    <div class="sidebar-about">
      <span class="site__title">
        <a href="https://www.ipreferjim.com/">I Prefer Jim</a>
      </span>
      
      
        <div class="author-image">
          <img src="https://www.gravatar.com/avatar/466dc28e15028c7353552022d2de1f9e?s=240&d=mp" class="img--circle img--headshot element--center" alt="gravatar">
        </div>
      
      <p class="site__description">
        
      </p>
    </div>
    <div class="collapsible-menu">
      <input type="checkbox" id="menuToggle">
      <label for="menuToggle">I Prefer Jim</label>
      <div class="menu-content">
        <div>
	<ul class="sidebar-nav">
		 
		 
			 
				<li>
					<a href="/posts/">
						<span>Posts</span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/tags/">
						<span>Tags</span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/categories/">
						<span>Categories</span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/books/">
						<span>Books</span>
					</a>
				</li>
			 
		
	</ul>
</div>

        <section class="social">
	
	<a href="https://twitter.com/jimschubert" rel="me"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a>
	
	
	
	<a href="https://github.com/jimschubert" rel="me"><i class="fab fa-github fa-lg" aria-hidden="true"></i></a>
	
	
	
	
	
	
	
	<a href="https://linkedin.com/in/jamesschubert" rel="me"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a>
	
	
	<a href="https://stackoverflow.com/users/151445" rel="me"><i class="fab fa-stack-overflow fa-lg" aria-hidden="true"></i></a>
	
	
	
	
	
	
	
	
</section>

      </div>
    </div>
    
<div class="copyright">
  &copy; 2020 Jim Schubert
  
    <a href="https://creativecommons.org/licenses/by-sa/4.0">CC BY-SA 4.0</a>
  
</div>


<div class="builtwith">
Built with <a href="https://gohugo.io">Hugo</a> ❤️ <a href="https://github.com/htr3n/hyde-hyde">hyde-hyde</a>.
</div>


  </div>
</div>

        <div class="content container">
            
    
<article>
  <header>
    <h1>System.ComponentModel.DataAnnotations for ASP.NET Web Forms</h1>
    
    
<div class="post__meta">
    
    
      <i class="fas fa-calendar-alt"></i> May 27, 2010
    
    
    
      
      
          in
          
          
              <a class="badge badge-category" href="/categories/blog">BLOG</a>
              
          
      
    
    
    
      
      
          <br/>
           <i class="fas fa-tags"></i>
          
          <a class="badge badge-tag" href="/tags/.net">.net</a>
           
      
          <a class="badge badge-tag" href="/tags/asp.net">asp.net</a>
           
      
          <a class="badge badge-tag" href="/tags/asp.net-mvc">asp.net mvc</a>
           
      
          <a class="badge badge-tag" href="/tags/c">c#</a>
           
      
          <a class="badge badge-tag" href="/tags/code">code</a>
           
      
          <a class="badge badge-tag" href="/tags/tricks">tricks</a>
          
      
    
    
    <br/>
    <i class="fas fa-clock"></i> 9 min read
</div>


  </header>
  
  
  
  
  <div class="post">
    <p>Although I’m primarily an ASP.NET Web Forms developer, I regularly dabble in new and interesting technologies.  I’ve toyed with other Microsoft technologies such as ASP.NET MVC and Dynamic Data web sites.</p>
<p>ASP.NET MVC offers an interesting mechanism for validating view models called DataAnnotations.   Examples can be seen <a title="here" href="http://bradwilson.typepad.com/blog/2009/04/dataannotations-and-aspnet-mvc.html" target="_blank">here</a> and <a title="here" href="http://www.asp.net/mvc/tutorials/validation-with-the-data-annotation-validators-cs" target="_blank">here</a>.</p>
<p>Some of the more useful attributes for validation include:</p>
<ul>
<li>RequiredAttribute</li>
<li>RegularExpressionAttribute</li>
<li>RangeAttribute</li>
<li>DataTypeAttribute</li>
</ul>
<p>I recently decided to implement a data validation schema (for lack of a better term) for web forms similar to that of ASP.NET MVC. This would allow us to maintain validation of a model object via attributes at the class level, instead of dispersing these validation rules through the web form code or any of the business logic layers. However, there will be occasions where an object’s validity depends upon some state or validity of another object. I’ve handled this by allowing the validation method to accept any action to be called after the object has been validated.</p>
<p>In order to make a domain object validatable, I’m going to implement the following interface:</p>
<p><strong>IValidatable.cs</strong></p>
<div class="highlight"><pre class="chroma"><code class="language-csharp" data-lang="csharp"><span class="k">namespace</span> <span class="nn">Validatable</span>
<span class="p">{</span>
    <span class="k">interface</span> <span class="n">IValidatable</span>
    <span class="p">{</span>
        <span class="n">System</span><span class="p">.</span><span class="n">Type</span> <span class="n">EntityType</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
        <span class="n">System</span><span class="p">.</span><span class="n">Collections</span><span class="p">.</span><span class="n">Generic</span><span class="p">.</span><span class="n">List</span><span class="p">&lt;</span><span class="kt">object</span><span class="p">&gt;</span> <span class="n">Errors</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>

        <span class="c1">/// &lt;summary&gt;
</span><span class="c1"></span>        <span class="c1">/// Determine whether the object is valid.  If invalid, errors are added to item.Errors
</span><span class="c1"></span>        <span class="c1">/// &lt;/summary&gt;
</span><span class="c1"></span>        <span class="c1">/// &lt;returns&gt;true if valid, false if invalid&lt;/returns&gt;
</span><span class="c1"></span>        <span class="kt">bool</span> <span class="n">IsValid</span><span class="p">();</span>

        <span class="c1">/// &lt;summary&gt;
</span><span class="c1"></span>        <span class="c1">/// Validate this item against a supplied action
</span><span class="c1"></span>        <span class="c1">/// &lt;/summary&gt;
</span><span class="c1"></span>        <span class="c1">/// &lt;param name=&#34;action&#34;&gt;The action to use for validation&lt;/param&gt;
</span><span class="c1"></span>        <span class="k">void</span> <span class="n">Validate</span><span class="p">(</span><span class="n">System</span><span class="p">.</span><span class="n">Action</span> <span class="n">action</span><span class="p">);</span>

        <span class="c1">/// &lt;summary&gt;
</span><span class="c1"></span>        <span class="c1">/// Validate this object against a Repository.
</span><span class="c1"></span>        <span class="c1">/// &lt;example&gt;
</span><span class="c1"></span>        <span class="c1">/// Item a = new Item();
</span><span class="c1"></span>        <span class="c1">/// a.Validate(new ItemRepository());
</span><span class="c1"></span>        <span class="c1">/// &lt;/example&gt;
</span><span class="c1"></span>        <span class="c1">/// Note: Repository must have a Validate(T item) method
</span><span class="c1"></span>        <span class="c1">/// &lt;/summary&gt;
</span><span class="c1"></span>        <span class="c1">/// &lt;param name=&#34;repository&#34;&gt;The Repository to use for validation&lt;/param&gt;
</span><span class="c1"></span>        <span class="k">void</span> <span class="n">Validate</span><span class="p">(</span><span class="kt">object</span> <span class="n">repository</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div><p>As you can see, this abstract class adds a property accessor for the entity’s type, a list of validation errors, an IsValid method, and two Validate methods.</p>
<h2 id="validatablet">Validatable<T></h2>
<p>I’ll take the code in chunks, since there is a lot more than I usually post.</p>
<p>First of all, the using directives required for this class are pretty sparse:</p>
<div class="highlight"><pre class="chroma"><code class="language-csharp" data-lang="csharp"><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
    <span class="k">using</span> <span class="nn">System.Collections.Generic</span><span class="p">;</span>
    <span class="k">using</span> <span class="nn">System.ComponentModel.DataAnnotations</span><span class="p">;</span>
    <span class="k">using</span> <span class="nn">System.Linq</span><span class="p">;</span>
    <span class="k">using</span> <span class="nn">System.Reflection</span><span class="p">;</span>
</code></pre></div><p>The class definition is:</p>
<div class="highlight"><pre class="chroma"><code class="language-csharp" data-lang="csharp"><span class="na">[Serializable]</span>
    <span class="k">public</span> <span class="k">abstract</span> <span class="k">class</span> <span class="nc">Validatable</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="p">:</span> <span class="n">IValidatable</span> <span class="k">where</span> <span class="n">T</span> <span class="p">:</span> <span class="n">class</span><span class="p">,</span> <span class="k">new</span><span class="p">()</span>
    <span class="p">{</span> <span class="cm">/* class */</span> <span class="p">}</span>
</code></pre></div><p>If you’re unfamiliar with generic constraints, the <strong>where T : class, new()</strong> above enforces the T passed as in to be a class and to have a parameterless constructor (<strong>new()</strong>)</p>
<p>The properties can be auto-implemented properties, or they can implement any backing logic you prefer. The constructor as I have it is:</p>
<div class="highlight"><pre class="chroma"><code class="language-csharp" data-lang="csharp"><span class="k">protected</span> <span class="n">Validatable</span><span class="p">()</span>
 <span class="p">{</span>
     <span class="n">Errors</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="kt">object</span><span class="p">&gt;();</span>
     <span class="n">EntityType</span> <span class="p">=</span> <span class="k">typeof</span><span class="p">(</span><span class="n">T</span><span class="p">);</span>
 <span class="p">}</span>
</code></pre></div><p>Now for the methods and a slight explanation of each:</p>
<p><strong>IsValid()</strong></p>
<div class="highlight"><pre class="chroma"><code class="language-csharp" data-lang="csharp"><span class="k">public</span> <span class="k">virtual</span> <span class="kt">bool</span> <span class="n">IsValid</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">Errors</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="kt">object</span><span class="p">&gt;();</span>
            <span class="n">PropertyInfo</span><span class="p">[]</span> <span class="n">props</span> <span class="p">=</span> <span class="k">this</span><span class="p">.</span><span class="n">GetType</span><span class="p">().</span><span class="n">GetProperties</span><span class="p">();</span>

            <span class="k">foreach</span> <span class="p">(</span><span class="n">PropertyInfo</span> <span class="n">property</span> <span class="k">in</span> <span class="n">props</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="k">foreach</span> <span class="p">(</span><span class="n">ValidationAttribute</span> <span class="n">va</span> <span class="k">in</span>
                    <span class="n">property</span><span class="p">.</span><span class="n">GetCustomAttributes</span><span class="p">(</span><span class="k">true</span><span class="p">).</span><span class="n">OfType</span><span class="p">&lt;</span><span class="n">ValidationAttribute</span><span class="p">&gt;())</span>
                <span class="p">{</span>
                    <span class="kt">var</span> <span class="k">value</span> <span class="p">=</span> <span class="n">property</span><span class="p">.</span><span class="n">GetValue</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="k">null</span><span class="p">);</span>
                    <span class="k">if</span> <span class="p">(!</span><span class="n">va</span><span class="p">.</span><span class="n">IsValid</span><span class="p">(</span><span class="k">value</span><span class="p">))</span>
                    <span class="p">{</span>
                        <span class="n">Errors</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="n">va</span><span class="p">.</span><span class="n">ErrorMessage</span><span class="p">);</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>

            <span class="k">return</span> <span class="n">Errors</span><span class="p">.</span><span class="n">Count</span> <span class="p">&lt;=</span> <span class="m">0</span><span class="p">;</span>
        <span class="p">}</span>
</code></pre></div><p>As a side note, all DataAnnotation attributes inherit from ValidationAttribute. You can create your own Validation Attributes by inheriting from this class. This method clears the list of errors and repopulates it by looping over any properties with validation attributes of this object, validates that property’s value against the attribute, and adds the ErrorMessage associated with it to the list of Errors.</p>
<p><strong>Validate Methods</strong></p>
<div class="highlight"><pre class="chroma"><code class="language-csharp" data-lang="csharp"><span class="k">public</span> <span class="k">virtual</span> <span class="k">void</span> <span class="n">Validate</span><span class="p">(</span><span class="n">Action</span> <span class="n">action</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">IsValid</span><span class="p">())</span>
            <span class="p">{</span>
                <span class="n">action</span><span class="p">();</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="k">virtual</span> <span class="k">void</span> <span class="n">Validate</span><span class="p">(</span><span class="kt">object</span> <span class="n">repository</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">MethodInfo</span> <span class="n">method</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">GetType</span><span class="p">().</span><span class="n">GetMethods</span><span class="p">()</span>
                <span class="p">.</span><span class="n">Where</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">Name</span><span class="p">.</span><span class="n">Equals</span><span class="p">(</span><span class="s">&#34;Validate&#34;</span><span class="p">)).</span><span class="n">FirstOrDefault</span><span class="p">();</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">method</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="kt">object</span><span class="p">[]</span> <span class="n">parameters</span> <span class="p">=</span> <span class="k">new</span> <span class="kt">object</span><span class="p">[]</span> <span class="p">{</span> <span class="k">this</span> <span class="p">};</span>
                <span class="n">Validate</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="n">method</span><span class="p">.</span><span class="n">Invoke</span><span class="p">(</span><span class="n">repository</span><span class="p">,</span> <span class="n">parameters</span><span class="p">));</span>
            <span class="p">}</span>
        <span class="p">}</span>
</code></pre></div><p>These two methods can be changed to throw an exception if the object is invalid. I’ll leave that up to you. The way these are set up is to allow you to validate the object and perform either some unknown action or call <strong>Validate(T item)</strong> against some other object, arbitrarily called a repository. In actuality, you could have a Validate method on some other object that takes an object of this type and essentially chain validations.</p>
<p>The simplicity of the Validate(Action action) method is what makes it beautiful. For instance, you can have an item (a) and cause it save after validation by doing something like:</p>
<div class="highlight"><pre class="chroma"><code class="language-csharp" data-lang="csharp"><span class="n">a</span><span class="p">.</span><span class="n">Validate</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="k">new</span> <span class="n">ItemDAL</span><span class="p">().</span><span class="n">Save</span><span class="p">(</span><span class="n">a</span><span class="p">));</span>
</code></pre></div><p>As you can see, a Save method in your Item’s Data Access Layer taking Item as a parameter can be called only when a.IsValid() is true. Again, there are a number of ways to tweak this and change it to your liking, but I’ll leave that up to you.</p>
<h2 id="dataannotationvalidator">DataAnnotationValidator</h2>
<p>Here is the wonderful part about all of this. You can create a custom validator that validates in a similar way as the Validatable class. I’ll post the code and quickly explain what it does. I got the idea from this from another blog and tweaked it a little.</p>
<p><strong>DataAnnotationValidator.cs</strong></p>
<div class="highlight"><pre class="chroma"><code class="language-csharp" data-lang="csharp"><span class="c1">// DataAnnotationValidator.cs
</span><span class="c1"></span><span class="k">namespace</span> <span class="nn">Validatable</span>
<span class="p">{</span>
    <span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
    <span class="k">using</span> <span class="nn">System.ComponentModel.DataAnnotations</span><span class="p">;</span>
    <span class="k">using</span> <span class="nn">System.Linq</span><span class="p">;</span>
    <span class="k">using</span> <span class="nn">System.Reflection</span><span class="p">;</span>
    <span class="k">using</span> <span class="nn">System.Web.UI</span><span class="p">;</span>
    <span class="k">using</span> <span class="nn">System.Web.UI.WebControls</span><span class="p">;</span>
<span class="na">
</span><span class="na">    [ToolboxData(&#34;&lt;{0}:DataAnnotationValidator runat=\&#34;server\&#34; ControlToValidate=\&#34;[Required]</span><span class="err">\</span><span class="s">&#34; Display=\&#34;Dynamic\&#34; Text=\&#34;*\&#34; SourceTypeName=\&#34;[FullyQualifiedTypeName]\&#34; PropertyToValidate=\&#34;[PropertyName]\&#34; /&gt;&#34;</span><span class="p">)]</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">DataAnnotationValidator</span> <span class="p">:</span> <span class="n">BaseValidator</span>
    <span class="p">{</span>
        <span class="c1">/// &lt;summary&gt;
</span><span class="c1"></span>        <span class="c1">/// THe Property that should be checked
</span><span class="c1"></span>        <span class="c1">/// &lt;/summary&gt;
</span><span class="c1"></span>        <span class="k">public</span> <span class="kt">string</span> <span class="n">PropertyToValidate</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>

        <span class="c1">/// &lt;summary&gt;
</span><span class="c1"></span>        <span class="c1">/// The object&#39;s type
</span><span class="c1"></span>        <span class="c1">/// &lt;/summary&gt;
</span><span class="c1"></span>        <span class="k">public</span> <span class="kt">string</span> <span class="n">SourceTypeName</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>

        <span class="k">protected</span> <span class="k">override</span> <span class="kt">bool</span> <span class="n">EvaluateIsValid</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">Type</span> <span class="n">source</span> <span class="p">=</span> <span class="n">GetValidatedType</span><span class="p">();</span>
            <span class="n">PropertyInfo</span> <span class="n">property</span> <span class="p">=</span> <span class="n">GetValidatedProperty</span><span class="p">(</span><span class="n">source</span><span class="p">);</span>
            <span class="kt">string</span> <span class="k">value</span> <span class="p">=</span> <span class="n">GetControlValidationValue</span><span class="p">(</span><span class="n">ControlToValidate</span><span class="p">);</span>

            <span class="k">foreach</span> <span class="p">(</span><span class="n">ValidationAttribute</span> <span class="n">va</span> <span class="k">in</span> <span class="n">property</span>
                <span class="p">.</span><span class="n">GetCustomAttributes</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="n">ValidationAttribute</span><span class="p">),</span> <span class="k">true</span><span class="p">)</span>
                <span class="p">.</span><span class="n">OfType</span><span class="p">&lt;</span><span class="n">ValidationAttribute</span><span class="p">&gt;())</span>
            <span class="p">{</span>
                <span class="k">if</span> <span class="p">(!</span><span class="n">va</span><span class="p">.</span><span class="n">IsValid</span><span class="p">(</span><span class="k">value</span><span class="p">))</span>
                <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span><span class="kt">string</span><span class="p">.</span><span class="n">IsNullOrEmpty</span><span class="p">(</span><span class="n">ErrorMessage</span><span class="p">))</span>
                    <span class="p">{</span>
                        <span class="k">this</span><span class="p">.</span><span class="n">ErrorMessage</span> <span class="p">=</span> <span class="n">va</span><span class="p">.</span><span class="n">ErrorMessage</span><span class="p">;</span>
                    <span class="p">}</span>
                    <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>

            <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">private</span> <span class="n">Type</span> <span class="n">GetValidatedType</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="kt">string</span><span class="p">.</span><span class="n">IsNullOrEmpty</span><span class="p">(</span><span class="n">SourceTypeName</span><span class="p">))</span>
            <span class="p">{</span>
                <span class="k">throw</span> <span class="k">new</span> <span class="n">InvalidOperationException</span><span class="p">(</span><span class="s">&#34;Null SourceTypeName can&#39;t be validated&#34;</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="n">Type</span> <span class="n">validatedType</span> <span class="p">=</span> <span class="n">Type</span><span class="p">.</span><span class="n">GetType</span><span class="p">(</span><span class="n">SourceTypeName</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">validatedType</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="k">throw</span> <span class="k">new</span> <span class="n">InvalidOperationException</span><span class="p">(</span>
                    <span class="kt">string</span><span class="p">.</span><span class="n">Format</span><span class="p">(</span><span class="s">&#34;{0}:{1}&#34;</span><span class="p">,</span> <span class="s">&#34;Invalid SourceTypeName&#34;</span><span class="p">,</span> <span class="n">SourceTypeName</span><span class="p">));</span>
            <span class="p">}</span>

            <span class="k">return</span> <span class="n">validatedType</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">private</span> <span class="n">PropertyInfo</span> <span class="n">GetValidatedProperty</span><span class="p">(</span><span class="n">Type</span> <span class="n">source</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">PropertyInfo</span> <span class="n">property</span> <span class="p">=</span> <span class="n">source</span><span class="p">.</span><span class="n">GetProperty</span><span class="p">(</span><span class="n">PropertyToValidate</span><span class="p">,</span>
              <span class="n">BindingFlags</span><span class="p">.</span><span class="n">Public</span> <span class="p">|</span> <span class="n">BindingFlags</span><span class="p">.</span><span class="n">Instance</span><span class="p">);</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">property</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="k">throw</span> <span class="k">new</span> <span class="n">InvalidOperationException</span><span class="p">(</span>
                  <span class="kt">string</span><span class="p">.</span><span class="n">Format</span><span class="p">(</span><span class="s">&#34;{0}:{1}&#34;</span><span class="p">,</span> <span class="s">&#34;Validated Property Does Not Exists&#34;</span><span class="p">,</span> <span class="n">PropertyToValidate</span><span class="p">));</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="n">property</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div><p>This creates a validator web control which has ‘PropertyToValidate’ and ‘SourceTypeName’. When a Validator web control is added to a page, it must have ControlToValidate, PropertyToValidate, and SourceTypeName specified or an error will be thrown. The validation method verifies the type and the property, gets the value of the property and finally, much like the Validatable abstract class, it loops over all ValidationAttributes and validates the value against that attribute. You can use this with multiple attributes, so it doesn’t hurt to add this validator to a property– that just means you can add an attribute in the future and everything is already wired up! That’s pretty cool.</p>
<h2 id="example">Example</h2>
<p>As an example, I’m going to create a single page to **input** a Customer object. The customer object is very simple:</p>
<div class="highlight"><pre class="chroma"><code class="language-csharp" data-lang="csharp"><span class="k">public</span> <span class="k">class</span> <span class="nc">Customer</span> <span class="p">:</span> <span class="n">Validatable</span><span class="p">.</span><span class="n">Validatable</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;</span>
    <span class="p">{</span>
<span class="na">        [Required(ErrorMessage=&#34;UserId is Required&#34;)]</span>
        <span class="k">public</span> <span class="kt">int</span> <span class="n">UserId</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
<span class="na">
</span><span class="na">        [DataType(DataType.PhoneNumber, ErrorMessage=&#34;Invalid Phone Number&#34;)]</span>
        <span class="k">public</span> <span class="kt">string</span> <span class="n">PhoneNumber</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
<span class="na">
</span><span class="na">        [RegularExpression(@&#34;(^\d{5}(-\d{4}){0,1}$)&#34;, ErrorMessage=&#34;Invalid Zip Code&#34;)]</span>
        <span class="k">public</span> <span class="kt">string</span> <span class="n">ZipCode</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
    <span class="p">}</span>
</code></pre></div><p>And the Page in full is collapsed below:</p>
<div class="highlight"><pre class="chroma"><code class="language-xml" data-lang="xml"><span class="err">&lt;</span>%@ Page Language=&#34;C#&#34; AutoEventWireup=&#34;true&#34; CodeBehind=&#34;Default.aspx.cs&#34; Inherits=&#34;Example._Default&#34; %&gt;
<span class="cp">&lt;!DOCTYPE html PUBLIC &#34;-//W3C//DTD XHTML 1.0 Transitional//EN&#34; &#34;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&#34;&gt;</span>

<span class="nt">&lt;html</span> <span class="na">xmlns=</span><span class="s">&#34;http://www.w3.org/1999/xhtml&#34;</span> <span class="nt">&gt;</span>
<span class="nt">&lt;head</span> <span class="na">runat=</span><span class="s">&#34;server&#34;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;title&gt;&lt;/title&gt;</span>
<span class="nt">&lt;/head&gt;</span>
<span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;form</span> <span class="na">id=</span><span class="s">&#34;form1&#34;</span> <span class="na">runat=</span><span class="s">&#34;server&#34;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;asp:Label</span> <span class="na">ID=</span><span class="s">&#34;lblStatus&#34;</span> <span class="na">runat=</span><span class="s">&#34;server&#34;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;asp:ValidationSummary</span> <span class="na">ID=</span><span class="s">&#34;ValidationSummary1&#34;</span> <span class="na">runat=</span><span class="s">&#34;server&#34;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;div&gt;</span>
        <span class="nt">&lt;asp:FormView</span> <span class="na">ID=</span><span class="s">&#34;FormView1&#34;</span> <span class="na">runat=</span><span class="s">&#34;server&#34;</span> <span class="na">DataSourceID=</span><span class="s">&#34;srcRepository&#34;</span> 
            <span class="na">Width=</span><span class="s">&#34;119px&#34;</span> <span class="na">AllowPaging=</span><span class="s">&#34;True&#34;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;EditItemTemplate&gt;</span>
                UserId:
                <span class="nt">&lt;asp:TextBox</span> <span class="na">ID=</span><span class="s">&#34;UserIdTextBox&#34;</span> <span class="na">runat=</span><span class="s">&#34;server&#34;</span> <span class="na">Text=</span><span class="s">&#39;&lt;%# Bind(&#34;UserId&#34;) %&gt;&#39;</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;example:DataAnnotationValidator</span> <span class="na">ID=</span><span class="s">&#34;DataAnnotationValidator1&#34;</span> <span class="na">runat=</span><span class="s">&#34;server&#34;</span> <span class="na">ControlToValidate=</span><span class="s">&#34;UserIdTextBox&#34;</span> <span class="na">Display=</span><span class="s">&#34;Dynamic&#34;</span>
                    <span class="na">PropertyToValidate=</span><span class="s">&#34;UserId&#34;</span> <span class="na">ErrorMessage=</span><span class="s">&#34;Invalid User Identification Number&#34;</span> 
                    <span class="na">SourceTypeName=</span><span class="s">&#34;Example.Customer, Example, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null&#34;</span> 
                    <span class="na">Text=</span><span class="s">&#34;*&#34;</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;br</span> <span class="nt">/&gt;</span>
                PhoneNumber:
                <span class="nt">&lt;asp:TextBox</span> <span class="na">ID=</span><span class="s">&#34;PhoneNumberTextBox&#34;</span> <span class="na">runat=</span><span class="s">&#34;server&#34;</span> 
                    <span class="na">Text=</span><span class="s">&#39;&lt;%# Bind(&#34;PhoneNumber&#34;) %&gt;&#39;</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;example:DataAnnotationValidator</span> <span class="na">ID=</span><span class="s">&#34;DataAnnotationValidator2&#34;</span> <span class="na">runat=</span><span class="s">&#34;server&#34;</span> <span class="na">ControlToValidate=</span><span class="s">&#34;PhoneNumberTextBox&#34;</span> <span class="na">Display=</span><span class="s">&#34;Dynamic&#34;</span>
                    <span class="na">PropertyToValidate=</span><span class="s">&#34;PhoneNumber&#34;</span> <span class="na">OnInit=</span><span class="s">&#34;GetTypeName&#34;</span> <span class="na">SourceTypeName=</span><span class="s">&#34;Example.Customer, Example, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null&#34;</span> <span class="na">Text=</span><span class="s">&#34;*&#34;</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;br</span> <span class="nt">/&gt;</span>
                ZipCode:
                <span class="nt">&lt;asp:TextBox</span> <span class="na">ID=</span><span class="s">&#34;ZipCodeTextBox&#34;</span> <span class="na">runat=</span><span class="s">&#34;server&#34;</span> <span class="na">Text=</span><span class="s">&#39;&lt;%# Bind(&#34;ZipCode&#34;) %&gt;&#39;</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;example:DataAnnotationValidator</span> <span class="na">ID=</span><span class="s">&#34;DataAnnotationValidator3&#34;</span> <span class="na">runat=</span><span class="s">&#34;server&#34;</span> <span class="na">ControlToValidate=</span><span class="s">&#34;ZipCodeTextBox&#34;</span> <span class="na">Display=</span><span class="s">&#34;Dynamic&#34;</span>
                    <span class="na">PropertyToValidate=</span><span class="s">&#34;ZipCode&#34;</span> <span class="na">SourceTypeName=</span><span class="s">&#34;Example.Customer, Example, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null&#34;</span> <span class="na">Text=</span><span class="s">&#34;*&#34;</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;br</span> <span class="nt">/&gt;</span>
                EntityType:
                <span class="nt">&lt;asp:TextBox</span> <span class="na">ID=</span><span class="s">&#34;EntityTypeTextBox&#34;</span> <span class="na">runat=</span><span class="s">&#34;server&#34;</span> 
                    <span class="na">Text=</span><span class="s">&#39;&lt;%# Eval(&#34;EntityType&#34;) %&gt;&#39;</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;br</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;asp:LinkButton</span> <span class="na">ID=</span><span class="s">&#34;UpdateButton&#34;</span> <span class="na">runat=</span><span class="s">&#34;server&#34;</span> <span class="na">CausesValidation=</span><span class="s">&#34;True&#34;</span> 
                    <span class="na">CommandName=</span><span class="s">&#34;Update&#34;</span> <span class="na">Text=</span><span class="s">&#34;Update&#34;</span> <span class="nt">/&gt;</span>
                <span class="ni">&amp;nbsp;</span><span class="nt">&lt;asp:LinkButton</span> <span class="na">ID=</span><span class="s">&#34;UpdateCancelButton&#34;</span> <span class="na">runat=</span><span class="s">&#34;server&#34;</span> 
                    <span class="na">CausesValidation=</span><span class="s">&#34;False&#34;</span> <span class="na">CommandName=</span><span class="s">&#34;Cancel&#34;</span> <span class="na">Text=</span><span class="s">&#34;Cancel&#34;</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;/EditItemTemplate&gt;</span>
            <span class="nt">&lt;InsertItemTemplate&gt;</span>
                UserId:
                <span class="nt">&lt;asp:TextBox</span> <span class="na">ID=</span><span class="s">&#34;UserIdTextBox&#34;</span> <span class="na">runat=</span><span class="s">&#34;server&#34;</span> <span class="na">Text=</span><span class="s">&#39;&lt;%# Bind(&#34;UserId&#34;) %&gt;&#39;</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;example:DataAnnotationValidator</span> <span class="na">ID=</span><span class="s">&#34;DataAnnotationValidator1&#34;</span> <span class="na">runat=</span><span class="s">&#34;server&#34;</span> <span class="na">ControlToValidate=</span><span class="s">&#34;UserIdTextBox&#34;</span> <span class="na">Display=</span><span class="s">&#34;Dynamic&#34;</span>
                    <span class="na">PropertyToValidate=</span><span class="s">&#34;UserId&#34;</span>  <span class="na">OnInit=</span><span class="s">&#34;GetTypeName&#34;</span>  <span class="na">Text=</span><span class="s">&#34;*&#34;</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;br</span> <span class="nt">/&gt;</span>
                PhoneNumber:
                <span class="nt">&lt;asp:TextBox</span> <span class="na">ID=</span><span class="s">&#34;PhoneNumberTextBox&#34;</span> <span class="na">runat=</span><span class="s">&#34;server&#34;</span> 
                    <span class="na">Text=</span><span class="s">&#39;&lt;%# Bind(&#34;PhoneNumber&#34;) %&gt;&#39;</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;example:DataAnnotationValidator</span> <span class="na">ID=</span><span class="s">&#34;DataAnnotationValidator2&#34;</span> <span class="na">runat=</span><span class="s">&#34;server&#34;</span> <span class="na">ControlToValidate=</span><span class="s">&#34;PhoneNumberTextBox&#34;</span> <span class="na">Display=</span><span class="s">&#34;Dynamic&#34;</span>
                    <span class="na">PropertyToValidate=</span><span class="s">&#34;PhoneNumber&#34;</span> <span class="na">OnInit=</span><span class="s">&#34;GetTypeName&#34;</span>  <span class="na">Text=</span><span class="s">&#34;*&#34;</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;br</span> <span class="nt">/&gt;</span>
                ZipCode:
                <span class="nt">&lt;asp:TextBox</span> <span class="na">ID=</span><span class="s">&#34;ZipCodeTextBox&#34;</span> <span class="na">runat=</span><span class="s">&#34;server&#34;</span> <span class="na">Text=</span><span class="s">&#39;&lt;%# Bind(&#34;ZipCode&#34;) %&gt;&#39;</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;example:DataAnnotationValidator</span> <span class="na">ID=</span><span class="s">&#34;DataAnnotationValidator3&#34;</span> <span class="na">runat=</span><span class="s">&#34;server&#34;</span> <span class="na">ControlToValidate=</span><span class="s">&#34;ZipCodeTextBox&#34;</span> <span class="na">Display=</span><span class="s">&#34;Dynamic&#34;</span>
                    <span class="na">PropertyToValidate=</span><span class="s">&#34;ZipCode&#34;</span> <span class="na">OnInit=</span><span class="s">&#34;GetTypeName&#34;</span>  <span class="na">Text=</span><span class="s">&#34;*&#34;</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;br</span> <span class="nt">/&gt;</span>
                EntityType:
                <span class="nt">&lt;asp:TextBox</span> <span class="na">ID=</span><span class="s">&#34;EntityTypeTextBox&#34;</span> <span class="na">runat=</span><span class="s">&#34;server&#34;</span> 
                    <span class="na">Text=</span><span class="s">&#39;&lt;%# Eval(&#34;EntityType&#34;) %&gt;&#39;</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;br</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;asp:LinkButton</span> <span class="na">ID=</span><span class="s">&#34;InsertButton&#34;</span> <span class="na">runat=</span><span class="s">&#34;server&#34;</span> <span class="na">CausesValidation=</span><span class="s">&#34;True&#34;</span> 
                    <span class="na">CommandName=</span><span class="s">&#34;Insert&#34;</span> <span class="na">Text=</span><span class="s">&#34;Insert&#34;</span> <span class="nt">/&gt;</span>
                <span class="ni">&amp;nbsp;</span><span class="nt">&lt;asp:LinkButton</span> <span class="na">ID=</span><span class="s">&#34;InsertCancelButton&#34;</span> <span class="na">runat=</span><span class="s">&#34;server&#34;</span> 
                    <span class="na">CausesValidation=</span><span class="s">&#34;False&#34;</span> <span class="na">CommandName=</span><span class="s">&#34;Cancel&#34;</span> <span class="na">Text=</span><span class="s">&#34;Cancel&#34;</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;/InsertItemTemplate&gt;</span>
            <span class="nt">&lt;ItemTemplate&gt;</span>
                UserId:
                <span class="nt">&lt;asp:Label</span> <span class="na">ID=</span><span class="s">&#34;UserIdTextBox&#34;</span> <span class="na">runat=</span><span class="s">&#34;server&#34;</span> <span class="na">Text=</span><span class="s">&#39;&lt;%# Bind(&#34;UserId&#34;) %&gt;&#39;</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;br</span> <span class="nt">/&gt;</span>
                PhoneNumber:
                <span class="nt">&lt;asp:Label</span> <span class="na">ID=</span><span class="s">&#34;PhoneNumberTextBox&#34;</span> <span class="na">runat=</span><span class="s">&#34;server&#34;</span> 
                    <span class="na">Text=</span><span class="s">&#39;&lt;%# Bind(&#34;PhoneNumber&#34;) %&gt;&#39;</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;br</span> <span class="nt">/&gt;</span>
                ZipCode:
                <span class="nt">&lt;asp:Label</span> <span class="na">ID=</span><span class="s">&#34;ZipCodeTextBox&#34;</span> <span class="na">runat=</span><span class="s">&#34;server&#34;</span> <span class="na">Text=</span><span class="s">&#39;&lt;%# Bind(&#34;ZipCode&#34;) %&gt;&#39;</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;br</span> <span class="nt">/&gt;</span>
                EntityType:
                <span class="nt">&lt;asp:Label</span> <span class="na">ID=</span><span class="s">&#34;EntityTypeLabel&#34;</span> <span class="na">runat=</span><span class="s">&#34;server&#34;</span> 
                    <span class="na">Text=</span><span class="s">&#39;&lt;%# Bind(&#34;EntityType&#34;) %&gt;&#39;</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;br</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;asp:LinkButton</span> <span class="na">ID=</span><span class="s">&#34;EditButton&#34;</span> <span class="na">runat=</span><span class="s">&#34;server&#34;</span> <span class="na">CausesValidation=</span><span class="s">&#34;False&#34;</span> 
                    <span class="na">CommandName=</span><span class="s">&#34;Edit&#34;</span> <span class="na">Text=</span><span class="s">&#34;Edit&#34;</span> <span class="nt">/&gt;</span>
                <span class="ni">&amp;nbsp;</span><span class="nt">&lt;asp:LinkButton</span> <span class="na">ID=</span><span class="s">&#34;NewButton&#34;</span> <span class="na">runat=</span><span class="s">&#34;server&#34;</span> <span class="na">CausesValidation=</span><span class="s">&#34;False&#34;</span> 
                    <span class="na">CommandName=</span><span class="s">&#34;New&#34;</span> <span class="na">Text=</span><span class="s">&#34;New&#34;</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;/ItemTemplate&gt;</span>
        <span class="nt">&lt;/asp:FormView&gt;</span>
        <span class="nt">&lt;asp:ObjectDataSource</span> <span class="na">ID=</span><span class="s">&#34;srcRepository&#34;</span> <span class="na">runat=</span><span class="s">&#34;server&#34;</span> 
            <span class="na">DataObjectTypeName=</span><span class="s">&#34;Example.Customer&#34;</span> <span class="na">InsertMethod=</span><span class="s">&#34;Save&#34;</span> 
            <span class="na">oninserted=</span><span class="s">&#34;srcRepository_Saved&#34;</span> <span class="na">onupdated=</span><span class="s">&#34;srcRepository_Saved&#34;</span> 
            <span class="na">SelectMethod=</span><span class="s">&#34;Get&#34;</span> <span class="na">TypeName=</span><span class="s">&#34;Example.CustomerRepository&#34;</span> <span class="na">UpdateMethod=</span><span class="s">&#34;Save&#34;</span><span class="nt">&gt;&lt;/asp:ObjectDataSource&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/form&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</code></pre></div><p>Of particular note here is in the EditTemplate, you’ll see</p>
<div class="highlight"><pre class="chroma"><code class="language-xml" data-lang="xml">UserId:
                <span class="nt">&lt;asp:TextBox</span> <span class="na">ID=</span><span class="s">&#34;UserIdTextBox&#34;</span> <span class="na">runat=</span><span class="s">&#34;server&#34;</span> <span class="na">Text=</span><span class="s">&#39;&lt;%# Bind(&#34;UserId&#34;) %&gt;&#39;</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;example:DataAnnotationValidator</span> <span class="na">ID=</span><span class="s">&#34;DataAnnotationValidator1&#34;</span> <span class="na">runat=</span><span class="s">&#34;server&#34;</span> <span class="na">ControlToValidate=</span><span class="s">&#34;UserIdTextBox&#34;</span> <span class="na">Display=</span><span class="s">&#34;Dynamic&#34;</span>
                    <span class="na">PropertyToValidate=</span><span class="s">&#34;UserId&#34;</span> <span class="na">ErrorMessage=</span><span class="s">&#34;Invalid User Identification Number&#34;</span> 
                    <span class="na">SourceTypeName=</span><span class="s">&#34;Example.Customer, Example, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null&#34;</span> 
                    <span class="na">Text=</span><span class="s">&#34;*&#34;</span><span class="nt">/&gt;</span>
</code></pre></div><p>in which the SourceTypeName must be the full Assembly Qualified Name. This is necessary if the Validatable<T> and DataAnnotationValidator classes are in an external library. This is a rather tedious property to fill for each validator. Another way to get around this is to populate the SourceTypeName as seen in the InserItemTemplate, e.g.</p>
<div class="highlight"><pre class="chroma"><code class="language-xml" data-lang="xml">UserId:
                <span class="nt">&lt;asp:TextBox</span> <span class="na">ID=</span><span class="s">&#34;UserIdTextBox&#34;</span> <span class="na">runat=</span><span class="s">&#34;server&#34;</span> <span class="na">Text=</span><span class="s">&#39;&lt;%# Bind(&#34;UserId&#34;) %&gt;&#39;</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;example:DataAnnotationValidator</span> <span class="na">ID=</span><span class="s">&#34;DataAnnotationValidator1&#34;</span> <span class="na">runat=</span><span class="s">&#34;server&#34;</span> <span class="na">ControlToValidate=</span><span class="s">&#34;UserIdTextBox&#34;</span> <span class="na">Display=</span><span class="s">&#34;Dynamic&#34;</span>
                    <span class="na">PropertyToValidate=</span><span class="s">&#34;UserId&#34;</span>  <span class="na">OnInit=</span><span class="s">&#34;GetTypeName&#34;</span>  <span class="na">Text=</span><span class="s">&#34;*&#34;</span><span class="nt">/&gt;</span>
</code></pre></div><p>and the code in the code behind is very simple:</p>
<div class="highlight"><pre class="chroma"><code class="language-csharp" data-lang="csharp"><span class="k">protected</span> <span class="k">void</span> <span class="n">GetTypeName</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">EventArgs</span> <span class="n">e</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">DataAnnotationValidator</span> <span class="n">validator</span> <span class="p">=</span> <span class="p">(</span><span class="n">DataAnnotationValidator</span><span class="p">)</span><span class="n">sender</span><span class="p">;</span>
            <span class="n">validator</span><span class="p">.</span><span class="n">SourceTypeName</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Customer</span><span class="p">().</span><span class="n">EntityType</span><span class="p">.</span><span class="n">AssemblyQualifiedName</span><span class="p">;</span>
        <span class="p">}</span>
</code></pre></div><p>Also notice that the first validator (the one with the assembly qualified name) has an ErrorMessage property specified. Doing this allows you to override the error message returned from the validated object. We can do this if the model says “UserId” and you want the user to see this property referred to as “User Identification”.</p>
<h2 id="conclusion">Conclusion</h2>
<p>Sometimes dabbling in other technologies can open the door for new and simpler ways of doing things. I like this example because it allows you to build web applications quickly and easily, while making them maintainable in the future (new validations only have to be added to the model, not to every control where the model must be validated).</p>
<p>For further reference, this project is linked below. Please download and modify if necessary.</p>
<p><a href="https://www.ipreferjim.com/wp-content/uploads/2010/05/Validatable.zip">Validatable.zip</a></p>

  </div>
  

<div class="navigation navigation-single">
    
    <a href="/2010/05/font-face-generator/" class="navigation-prev">
      <i aria-hidden="true" class="fa fa-chevron-left"></i>
      <span class="navigation-tittle">Font-Face generator</span>
    </a>
    
    
    <a href="/2010/05/javascript-color-picker/" class="navigation-next">
      <span class="navigation-tittle">JavaScript color picker</span>
      <i aria-hidden="true" class="fa fa-chevron-right"></i>
    </a>
    
</div>


  


<div class="post__related">
    
    <h2>Related Articles</h2>
    <ul class="related-posts">
        
<li>
  <span class="list__title--small">
    <a href="/2010/05/nhibernate-criterion-extensions-workaround/" >NHibernate.Criterion Extensions workaround</a>
      
      <time class="pull-right hidden-tablet">May 3, 2010</time>
      
  </span>
</li>

<li>
  <span class="list__title--small">
    <a href="/2010/05/finding-a-users-local-time-from-utc-offset/" >Finding a user’s local time from UTC offset</a>
      
      <time class="pull-right hidden-tablet">May 4, 2010</time>
      
  </span>
</li>

<li>
  <span class="list__title--small">
    <a href="/2010/02/quickly-create-a-dictionary-using-linq-to-objects/" >Quickly create a Dictionary using Linq to Objects</a>
      
      <time class="pull-right hidden-tablet">Feb 10, 2010</time>
      
  </span>
</li>

<li>
  <span class="list__title--small">
    <a href="/2010/05/copycat-activesupport-time-extensions/" >CopyCat Rails’ Time Extensions</a>
      
      <time class="pull-right hidden-tablet">May 3, 2010</time>
      
  </span>
</li>

<li>
  <span class="list__title--small">
    <a href="/2010/04/dry-genericcomparer-for-sorting-generic-lists/" >DRY! GenericComparer&lt;TType&gt; for sorting Generic Lists</a>
      
      <time class="pull-right hidden-tablet">Apr 22, 2010</time>
      
  </span>
</li>


    </ul>
</div>



  
    


</article>


        </div>
        
    

<script defer src="https://use.fontawesome.com/releases/v5.11.2/js/all.js" integrity="sha384-b3ua1l97aVGAPEIe48b4TC60WUQbQaGi2jqAWM90y0OZXZeyaTCWtBTKtjW2GXG1" crossorigin="anonymous"></script>


    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/highlight.min.js"></script>
        
    <script type="text/javascript">
        
        hljs.initHighlightingOnLoad();
    </script>
    





    



    </body>
</html>
